(function(a){a.fn.infinitescroll=function(c,b){function e(b){var c=0;a(b).children().each(function(){c+=a(this).outerHeight(!1)});return c}function f(b){b=a(b).length+a(b).html().length+a(b).attr("class").length+a(b).attr("id").length;d.infid=b}if(typeof c=="string"){var g=c,h=a.fn.infinitescroll._debug,g=g=="pause"||g=="destroy"||g=="retrieve"||g=="binding"?a.fn.infinitescroll[g](b||null):h("Invalid command");return!1}var d=a.infinitescroll.opts=a.extend({},a.infinitescroll.defaults,c),i=a.infinitescroll,
b=a.fn.infinitescroll._callback=b||function(){},h=a.fn.infinitescroll._debug;destroy=a.fn.infinitescroll.destroy;binding=a.fn.infinitescroll.binding;if(!function(b){var c=a.fn.infinitescroll._debug,d;for(d in b){if(d.indexOf&&d.indexOf("Selector")>-1&&a(b[d]).length===0)return c("Your "+d+" found no elements."),!1;return!0}}(d))return!1;d.container=d.container||document.documentElement;d.contentSelector=d.contentSelector||this;d.infid=d.infid==0?f(d.contentSelector):d.infid;d.loadMsgSelector=d.loadMsgSelector||
d.contentSelector;if(g=a(d.nextSelector).attr("href"))return d.path=function(b){if(a.isFunction(d.pathParse))return h("pathParse"),[b];else if(b.match(/^(.*?)\b2\b(.*?$)/))b=b.match(/^(.*?)\b2\b(.*?$)/).slice(1);else if(b.match(/^(.*?)2(.*?$)/)){if(b.match(/^(.*?page=)2(\/.*|$)/))return b=b.match(/^(.*?page=)2(\/.*|$)/).slice(1);b=b.match(/^(.*?)2(.*?$)/).slice(1)}else if(b.match(/^(.*?page=)1(\/.*|$)/))return b=b.match(/^(.*?page=)1(\/.*|$)/).slice(1);else h("Sorry, we couldn't parse your Next (Previous Posts) URL. Verify your the css selector points to the correct A tag. If you still get this error: yell, scream, and kindly ask for help at infinite-scroll.com."),
i.isInvalidPage=!0;h("determinePath",b);return b}(g),i.loadingMsg=a('<div id="infscr-loading" style="text-align: center;"><img alt="Loading..." src="'+d.loadingImg+'" /><div>'+d.loadingText+"</div></div>"),(new Image).src=d.loadingImg,d.binder=d.container.nodeName=="HTML"?a(window):a(d.container),g=d.container.nodeName=="HTML"?a(document).height():g=e(d.container),h("Scrolling in: ",d.container.nodeName=="HTML"?"window":d.container),d.pixelsFromNavToBottom=g+(d.container==document.documentElement?
0:a(d.container).offset().top)-a(d.navSelector).offset().top,binding("bind"),d.binder.trigger("smartscroll.infscr."+d.infid),this;else h("Navigation selector not found")};a.infinitescroll={defaults:{debug:!1,binder:a(window),preload:!1,nextSelector:"div.navigation a:first",loadingImg:"http://www.infinite-scroll.com/loading.gif",loadingText:"<em>Loading the next set of posts...</em>",donetext:"<em>Congratulations, you've reached the end of the internet.</em>",navSelector:"div.navigation",contentSelector:null,
loadMsgSelector:null,loadingMsgRevealSpeed:"fast",extraScrollPx:150,itemSelector:"div.post",animate:!1,pathParse:void 0,dataType:"html",appendCallback:!0,bufferPx:40,orientation:"height",errorCallback:function(){},afterLoadCallback:function(){},currPage:1,infid:0,isDuringAjax:!1,isInvalidPage:!1,isDestroyed:!1,isDone:!1,isPaused:!1,container:void 0,pixelsFromNavToBottom:void 0,path:void 0},loadingImg:void 0,loadingMsg:void 0,currDOMChunk:null};a.fn.infinitescroll._debug=function(){if(a.infinitescroll.opts.debug)return window.console&&
console.log.call(console,arguments)};a.fn.infinitescroll._shorthand=function(){};a.fn.infinitescroll._nearbottom=function(){var c=a.infinitescroll.opts,b=a.fn.infinitescroll._debug,e=a.fn.infinitescroll._hiddenheight,e=c.container.nodeName=="HTML"?0+a(document).height()-(a(c.container).scrollTop()||a(c.container.ownerDocument.body).scrollTop())-a(window).height():0+e(c.container)-a(c.container).scrollTop()-a(c.container).height();b("math:",e,c.pixelsFromNavToBottom);return e-c.bufferPx<c.pixelsFromNavToBottom};
a.fn.infinitescroll._setup=function(){var c=a.infinitescroll.opts,b=a.fn.infinitescroll._nearbottom,e=a.fn.infinitescroll.retrieve;!c.isDuringAjax&&!c.isInvalidPage&&!c.isDone&&!c.isDestroyed&&!c.isPaused&&b(c,a.infinitescroll)&&e()};a.fn.infinitescroll.retrieve=function(){var c=a.infinitescroll,b=c.opts,e=a.fn.infinitescroll._debug,f=a.fn.infinitescroll._loadcallback,g=a.fn.infinitescroll._error,h=b.path,d,i,k,j;b.isDuringAjax=!0;c.loadingMsg.appendTo(b.loadMsgSelector).show(b.loadingMsgRevealSpeed,
function(){a(b.navSelector).hide();b.currPage++;e("heading into ajax",h);d=a(b.contentSelector).is("table")?a("<tbody/>"):a("<div/>");i=a.isFunction(b.pathParse)?b.pathParse(h.join("2"),b.currPage):i=h.join(b.currPage);k=b.dataType=="html"||b.dataType=="json"?b.dataType:"html+callback";b.appendCallback&&b.dataType=="html"&&(k+="+callback");switch(k){case "html+callback":e("Using HTML via .load() method");d.load(i+" "+b.itemSelector,null,function(b){f(d,b.responseText);a.infinitescroll.opts.afterLoadCallback.call()});
break;case "html":case "json":e("Using "+k.toUpperCase()+" via $.ajax() method"),a.ajax({url:i,dataType:b.dataType,complete:function(b,c){(j=typeof b.isResolved!=="undefined"?b.isResolved():c==="success"||c==="notmodified")?f(d,b.responseText):g([404]);a.infinitescroll.opts.afterLoadCallback.call()}})}})};a.fn.infinitescroll._loadcallback=function(c,b){var e=a.infinitescroll,f=a.infinitescroll.opts,g=a.fn.infinitescroll._error,h=a.fn.infinitescroll._donemsg,d=a.fn.infinitescroll._callback;switch(f.isDone?
"done":!f.appendCallback?"no-append":"append"){case "done":return h(),!1;case "no-append":f.dataType=="html"&&(b=a("<div>"+b+"</div>").find(f.itemSelector));break;case "append":h=c.children();if(h.length==0||h.hasClass("error404"))return g([404]);for(g=document.createDocumentFragment();c[0].firstChild;)g.appendChild(c[0].firstChild);a(f.contentSelector)[0].appendChild(g);b=h.get()}e.loadingMsg.fadeOut("normal");f.animate&&(e=a(window).scrollTop()+a("#infscr-loading").height()+f.extraScrollPx+"px",
a("html,body").animate({scrollTop:e},800,function(){f.isDuringAjax=!1}));if(!f.animate)f.isDuringAjax=!1;d.call(a(f.contentSelector)[0],b)};a.fn.infinitescroll._donemsg=function(){var c=a.infinitescroll.opts;a.infinitescroll.loadingMsg.find("img").hide().parent().find("div").html(c.donetext).animate({opacity:1},2E3,function(){a(this).parent().fadeOut("normal")});c.errorCallback()};a.fn.infinitescroll.pause=function(c){var b=a.fn.infinitescroll._debug,e=a.infinitescroll.opts;c!=="pause"&&c!=="resume"&&
c!=="toggle"&&c!==null&&b("Invalid argument. Toggling pause value instead");switch(c&&(c=="pause"||c=="resume")?c:"toggle"){case "pause":e.isPaused=!0;break;case "resume":e.isPaused=!1;break;case "toggle":e.isPaused=!e.isPaused}b("Paused",e.isPaused);return!1};a.fn.infinitescroll._error=function(c){var b=a.infinitescroll.opts,e=b.container.nodeName=="HTML"?a(window):a(b.container),f=a.fn.infinitescroll._debug,g=a.fn.infinitescroll._donemsg;switch(!b.isDone&&c==404?"end":b.isDestroyed&&c==302?"destroy":
"unknown"){case "end":f("Page not found. Self-destructing...");g();b.isDone=!0;b.currPage=1;b.isPaused=!1;e.unbind("smartscroll.infscr."+b.infid);break;case "destroy":f("Destroyed. Going to next instance...");b.isDone=!0;b.currPage=1;b.isPaused=!1;e.unbind("smartscroll.infscr."+b.infid);break;case "unknown":f("Unknown Error. WHAT DID YOU DO?!..."),g(),b.isDone=!0,b.currPage=1,e.unbind("smartscroll.infscr."+b.infid)}};a.fn.infinitescroll.destroy=function(){var c=a.fn.infinitescroll._error;a.infinitescroll.opts.isDestroyed=
!0;return c([302])};a.fn.infinitescroll.binding=function(c){var b=a.infinitescroll.opts,e=a.fn.infinitescroll._setup,f=a.fn.infinitescroll._debug;switch(c){case "bind":b.binder.bind("smartscroll.infscr."+b.infid,e);break;case "unbind":b.binder.unbind("smartscroll.infscr."+b.infid)}f("Binding",c);return!1};var j=a.event,l;j.special.smartscroll={setup:function(){a(this).bind("scroll",j.special.smartscroll.handler)},teardown:function(){a(this).unbind("scroll",j.special.smartscroll.handler)},handler:function(a,
b){var e=this,f=arguments;a.type="smartscroll";l&&clearTimeout(l);l=setTimeout(function(){jQuery.event.handle.apply(e,f)},b==="execAsap"?0:100)}};a.fn.smartscroll=function(a){return a?this.bind("smartscroll",a):this.trigger("smartscroll",["execAsap"])}})(jQuery);